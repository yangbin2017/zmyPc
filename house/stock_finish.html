<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>测试</title>
    <meta name="description" content="overview &amp; stats"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- basic styles -->

    <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="../assets/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="../assets/css/jquery-ui-1.10.3.full.min.css"/>
    <link rel="stylesheet" href="../assets/css/datepicker.css"/>
    <link rel="stylesheet" href="../assets/css/ui.jqgrid.css"/>
    <!--<link rel="stylesheet" href="../css/jqGrid.css">-->

    <!--[if IE 7]>
    <link rel="stylesheet" href="../assets/css/font-awesome-ie7.min.css"/>
    <![endif]-->
    <link rel="stylesheet" href="../css/zmht2.css">
    <link href="../css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <!-- page specific plugin styles -->

    <!-- fonts -->

    <link rel="stylesheet" href="../assets/css/ace-fonts.css"/>

    <!-- ace styles -->

    <link rel="stylesheet" href="../assets/css/ace.min.css"/>
    <link rel="stylesheet" href="../assets/css/ace-rtl.min.css"/>
    <link rel="stylesheet" href="../assets/css/ace-skins.min.css"/>
    <link href="../css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/jquery.datetimepicker.css"/>
    <!--<link rel="stylesheet" href="../css/common.css">-->
    <link rel="stylesheet" href="../css/main.css">
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="../assets/css/ace-ie.min.css"/>
    <![endif]-->

    <!-- inline styles related to this page -->

    <!-- ace settings handler -->

    <script src="../assets/js/ace-extra.min.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

    <!--[if lt IE 9]>
    <script src="../assets/js/html5shiv.js"></script>
    <script src="../assets/js/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
        window.jQuery || document.write("<script src='../assets/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>
    <style>
        .tabs-container{
            margin: 0 ;
            padding:20px;
        }
        #tab-1 {
            background-color: #f6f6f6;
            padding: 15px;
        }
        .ui-jqgrid tr.jqgrow td{
            overflow: inherit;
            white-space: normal;
        }
    </style>
</head>

<body>


<div class="main-container" id="main-container">
    <!-- <script type="text/javascript">
        try{ace.settings.check('main-container' , 'fixed')}catch(e){}
    </script> -->

    <div class="main-container-inner">

        <div class="main-content-right">
            <div class="body-content body-content-bg">

                <div class="inner-scollcontent" >
                    <div class="ibox" style="margin-bottom: 0" id="modify-shop">
                        <div class="tabs-container">
                            <div class="margin-t10 zmwrap border-none">
                                <ul class="nav nav-tabs" role="presentation">
                                    <li class="active"><a href="#useShop" role="tab" data-toggle="tab">未盘点</a></li>
                                    <li class=""><a href="#deleteShop" role="tab" data-toggle="tab">已盘点</a></li>
                                </ul>
                                <div class="tab-content">
                                    <!--功能条-->
                                    <div role="tabpanel" id="useShop" class="tab-pane active">
                                        <div class="panel-body">
                                            <div class="zmbox clearfix margin-left-right-0  page-search-area">
                                                <form role="form"  class="form-inline" method="get" action="">
                                                    <div class="boxpart">
                                                        <div class="t">商品名称/条码：</div>
                                                        <div class="inpt">
                                                            <input type="text" class="form-control" name="keyword">
                                                        </div>
                                                        <div class="boxbtn">
                                                            <button type="submit" class="btn btn-primary">查询</button>
                                                        </div>
                                                    </div>
                                                    <!-- 下拉框-->
                                                    <div class="boxpart" style="padding-right: 15px">
                                                        <div class="t">分类筛选：</div>
                                                        <div class="inpt ">
                                                            <div class="select-box goods_type_id" >
                                                                <div class="bill-input ">
                                                                    <input type="text" value="全部">
                                                                    <i class="icon-sort-down"></i>
                                                                </div>
                                                                <div class="select-down role-select" style="display: none;">
                                                                    <div class="select-list">全部</div>
                                                                    <div class="select-list">休闲食品</div>
                                                                    <div class="select-list">饮料</div>
                                                                    <div class="select-list">粮油</div>
                                                                    <div class="select-list">日用</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="inpt ">
                                                            <div class="select-box " >
                                                                <div class="bill-input ">
                                                                    <input type="text" value="全部">
                                                                    <i class="icon-sort-down"></i>
                                                                </div>
                                                                <div class="select-down goods_son_id" style="display: none;">
                                                                    <div class="select-list">全部</div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="boxpart">
                                                        <a class="reset" href="javascript:;">清空筛选条件</a>
                                                    </div>

                                                </form>
                                            </div>
                                            <!--功能条-->
                                            <div class="zmbox clearfix margin-left-right-0 page-title-area">
                                                <div class="boxpart page-title">
                                                    <span class="txt1">未盘点商品列表</span>
                                                </div>
                                                <button class="btn btn-success pull-right btn-iframe" type="button"   data-form="#search-form">导出盘点单</button>
                                                <button class="btn btn-primary pull-right margin-r10 btn-ajax" type="button"  onclick="stock_ban()" >终止盘点单</button>
                                            </div>
                                            <div class="margin-t10">
                                                <table id="stockNotFinsh-table"></table>
                                                <div class="zmalertno nodata" style="margin:10px 0 0 0;">
                                                    <i class="icon-exclamation-sign"></i> <span>暂无数据</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div role="tabpanel" id="deleteShop" class="tab-pane ">
                                        <div class="panel-body">
                                            <!--显示内容-->
                                            <div class="zmbox clearfix margin-left-right-0 page-search-area">
                                                <form role="form" id="search-form" class="form-inline" method="get" action="">
                                                    <!-- 输入框-->
                                                    <div class="boxpart">
                                                        <div class="t">商品名称/条码：</div>
                                                        <div class="inpt">
                                                            <input type="text" class="form-control" name="keyword" id="keyword">
                                                        </div>
                                                        <div class="boxbtn">
                                                            <button type="submit" class="btn btn-primary">查询</button>
                                                        </div>
                                                    </div>
                                                    <!-- 下拉框-->
                                                    <div class="boxpart" style="padding-right: 15px">
                                                        <div class="t">分类筛选：</div>
                                                        <div class="inpt ">
                                                            <div class="select-box goods_type_id" >
                                                                <div class="bill-input ">
                                                                    <input type="text" value="全部">
                                                                    <i class="icon-sort-down"></i>
                                                                </div>
                                                                <div class="select-down role-select" style="display: none;">
                                                                    <div class="select-list">全部</div>
                                                                    <div class="select-list">休闲食品</div>
                                                                    <div class="select-list">饮料</div>
                                                                    <div class="select-list">粮油</div>
                                                                    <div class="select-list">日用</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="inpt ">
                                                            <div class="select-box " >
                                                                <div class="bill-input ">
                                                                    <input type="text" value="全部">
                                                                    <i class="icon-sort-down"></i>
                                                                </div>
                                                                <div class="select-down goods_son_id" style="display: none;">
                                                                    <div class="select-list">全部</div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="boxpart">
                                                        <a class="reset" href="javascript:;">清空筛选条件</a>
                                                    </div>

                                                </form>
                                            </div>
                                            <!--功能条-->
                                            <div class="zmbox clearfix margin-left-right-0 page-title-area">
                                                <div class="boxpart page-title">
                                                    <span class="txt1">已盘点商品列表</span>
                                                </div>
                                                <button class="btn btn-success pull-right btn-iframe btn-print" type="button">导出盘点单</button>
                                                <button class="btn btn-primary pull-right margin-r10 btn-ajax" type="button" onclick="stock_ban()">终止盘点单</button>
                                            </div>
                                            <div class="margin-t10">
                                                <table id="stockFinshshopList-table"></table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- /.main-content -->
    </div><!-- /.main-container-inner -->
</div><!-- /.main-container -->

<!-- 商品重盘 -->
<div class="modals restockShop">
    <div class="modals-dilog w-600" style="top: 50px;min-height: 200px">
        <div class="modals-content">
            <div class="modals-head">
                <span>商品重盘</span>
                <div class="close-m closeModals">&times;</div>
            </div>
            <div class="modals-body maxheight">
                <div class="modals-body-content">
                    <div class="madals-container active">
                        <!-- Tab panes -->
                        <div class="tab-content " style="border-bottom: none;max-height: 580px;">
                            <form class="form-horizontal" id="restock-form" action="" method="post">
                                <div class="modal-body">
                                <!--    <h3 class="zm-h3">商品信息</h3>
                                    <div class="row">
                                        <div class="col-xs-5">
                                            <div style="width: 130px;max-height: 130px;margin: 0 auto">
                                                <img src="https://b.izhangmai.com/img/default.png" style="width: 120px;max-height: 120px;">
                                            </div>

                                        </div>
                                        <div class="col-xs-7">
                                            <p>商品名称：123测试1</p>
                                            <p>商品条码：123</p>
                                            <p>单位：袋</p>
                                            <p>分类：饮料/碳酸饮料                        </p>
                                        </div>
                                    </div>
                                    <h3 class="zm-h3" style="margin-top: 15px">重新盘点</h3>
                                    <div class="row">
                                        <div class="col-xs-8">
                                           <table id="restockshop-table"></table>
                                        </div>
                                        <div class="col-xs-4">
                                            <div>重盘库存：</div>
                                            <div style="margin-top: 6px">
                                                <input type="text" class="form-control" maxlength="10" id="restock-number" name="goods[0][stock_inventory]" value="" datatype="n|decmall" nullmsg="请输入重盘数量" errormsg="数量只能是数字">
                                            </div>
                                        </div>
                                    </div>  -->
                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary">保存</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--[if !IE]> -->

<script type="text/javascript">
    window.jQuery || document.write("<script src='../assets/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
</script>
<!-- <![endif]-->

<!--[if IE]>
<script type="text/javascript">
    window.jQuery || document.write("<script src='../assets/js/jquery-1.10.2.min.js'>" + "<" + "/script>");
</script>
<![endif]-->

<script type="text/javascript">
    if ("ontouchend" in document) document.write("<script src='../assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/typeahead-bs2.min.js"></script>

<!-- page specific plugin scripts -->

<!--[if lte IE 8]>
<script src="../assets/js/excanvas.min.js"></script>
<![endif]-->

<script src="../assets/js/jquery-ui-1.10.3.custom.min.js"></script>
<script src="../assets/js/jquery.ui.touch-punch.min.js"></script>
<script src="../assets/js/jquery.slimscroll.min.js"></script>

<script src="../assets/js/jquery.sparkline.min.js"></script>

<!--<script src="../assets/js/jqGrid/jquery.jqGrid.min.js"></script>-->

<!--<script src="../assets/js/jqGrid/i18n/grid.locale-cn.js"></script>-->
<script src="../assets/js/jqGrid/jquery.jqGrid.min.js"></script>
<script src="../assets/js/jqGrid/i18n/grid.locale-cn.js"></script>
<!--<script src="../js/jqGrid.js"></script>-->
<!--<script src="../assets/js/jqGrid/jquery.jqGrid.src.js"></script>-->
<script src="../assets/js/date-time/bootstrap-datepicker.min.js"></script>
<script src="../assets/js/date-time/bootstrap-timepicker.min.js"></script>
<script src="../js/plugins/sweetalert/sweetalert.min.js"></script>
<script src="../js/jquery.datetimepicker.js" type="text/javascript" charset="utf-8"></script>
<!-- ace scripts -->
<script src="../assets/js/jquery.validate.min.js"></script>
<script src="../assets/js/jquery.gritter.min.js"></script>
<script src="../assets/js/ace-elements.min.js"></script>
<script src="../assets/js/ace.min.js"></script>

<script src="../js/main.js"></script>

<!--<script src="../js/echarts.min.js"></script>-->
<!-- inline scripts related to this page -->

<script type="text/javascript">

    var stockFinshshopListCol= [
        {
            label : '条码',
            name: 'barcode',
            align:'center',
            width: 200,
        },
        {
            label: '商品名称',
            name: 'shopName',
            width: 300,
            align:'left',
        },
        {
            label: '规格',
            name: 'standard',
            align:'center',
            width: 180,
        },
        {
            label: '单位',
            name: 'unit',
            align:'center',
            width: 180,
        },
        {
            label: '分类',
            name: 'type',
            align:'center',
            width: 180,
        },
        {
            label: '盘点库存',
            name: 'modal',
            align:'center',
            width: 180,

        },

        {
            label: '操作',
            name: 'operation',
            align:'center',
            width: 200,
            formatter: function (cellvalue, options, rowObject) {
                var gid = "'#"+options.gid +"'";
                var str='<span class="table-bar" onclick="stock_repeat('+ rowObject.id + ','+ gid + ')">重盘</span>';

                return str;
            }
        }
    ];
    jqgridTable({
        "tableId":"#stockFinshshopList-table",
        "pagerId":"",
        "url":"../data/shop/shopmanageList.json",
        "colModel":stockFinshshopListCol,
        "footerrow":false,
        "height":"100%",
        "cellEdit":false,
        "footerrowFun":'',
        "multiselect":false

    });



    //未盘点
    var stockNotFinshCol= [
        {
            label : '条码',
            name: 'barcode',
            align:'center',
            width: 260,
        },
        {
            label: '商品名称',
            name: 'shopName',
            width: 300,
            align:'left',
        },
        {
            label: '规格',
            name: 'standard',
            align:'center',
            width: 200,
        },
        {
            label: '单位',
            name: 'unit',
            align:'center',
            width: 200,
        },
        {
            label: '分类',
            name: 'type',
            align:'center',
            width: 200,
        },
        {
            label: '盘点库存',
            name: 'type',
            align:'center',
            width: 400,
            formatter: function (cellvalue, options, rowObject) {
                var gid = "'#"+options.gid +"'";
                var str='<input type="text" name="stock_num" style="width: 120px;height: 30px;vertical-align: middle;padding-left: 10px" class="line-30">' +
                        '<button type="submit" class="btn btn-primary stock_num_save" >保存</button>';

                return str;
            }
        }
    ];
    jqgridTable({
        "tableId":"#stockNotFinsh-table",
        "pagerId":"",
        "url":"../data/shop/shopmanageList.json",
        "colModel":stockNotFinshCol,
        "footerrow":false,
        "height":"100%",
        "cellEdit":false,
        "footerrowFun":'',
        "multiselect":false

    });

    //重盘
    function stock_repeat(rowId,gid){
        $('.restockShop').show();
        var str='<h3 class="zm-h3">商品信息</h3>\
                <div class="row">\
                <div class="col-xs-5">\
                <div style="width: 130px;max-height: 130px;margin: 0 auto">\
                <img src="https://b.izhangmai.com/img/default.png" style="width: 120px;max-height: 120px;">\
                </div>\
                </div>\
                <div class="col-xs-7">\
                <p>商品名称：123测试1</p>\
        <p>商品条码：123</p>\
        <p>单位：袋</p>\
        <p>分类：饮料/碳酸饮料                        </p>\
        </div>\
        </div>\
        <h3 class="zm-h3" style="margin-top: 15px">重新盘点</h3>\
                <div class="row">\
                <div class="col-xs-8">\
                <table id="restockshop-table"></table>\
                </div>\
                <div class="col-xs-4">\
                <div>重盘库存：</div>\
        <div style="margin-top: 6px">\
            <input type="text" class="form-control" maxlength="10" id="restock-number" name="goods[0][stock_inventory]" value="" datatype="n|decmall" nullmsg="请输入重盘数量" errormsg="数量只能是数字">\
        </div>\
        </div>\
        </div>';

        $('#restock-form .modal-body').empty().append(str)
        var restockshopCol= [
            {
                label : '时间',
                name: 'stockTime',
                align:'center',
                width: 120,
            },
            {
                label: '盘点人',
                name: 'stockUser',
                align:'center',
                width: 80,
            },
            {
                label: '盘点库存',
                name: 'stockStore',
                align:'center',
                width: 80,
            }
        ];
        jqgridTable({
            "tableId":"#restockshop-table",
            "pagerId":"",
            "url":"../data/shop/restockshop.json",
            "colModel":restockshopCol,
            "footerrow":false,
            "height":"100%",
            "cellEdit":false,
            "footerrowFun":'',
            "multiselect":false

        });
    }
    //终止
    function stock_ban(rowId,gid){
        swal({
            title: "确定要终止该盘点单吗？",
            text: false,
            type: "warning",
            showCancelButton: true,
            closeOnConfirm: true,
            confirmButtonText: false,
            confirmButtonColor: "#ec6c62"
        }, function () {
            swal({
                title: "终止成功",
                text: false,
                type: "success",
                showCancelButton: false,
                showConfirmButton: false,
                timer: 2000,
            })
            $.appServer.updateStaffStateById({
                        loginToken: "B1EBE47605952CF875EB795F811CE3E4",
                        staffId: staffId,
                        companys: companys,
                    },
                    function (data) {
                        if (data.output.flag == true) {
                            var pageIndex=localStorage.getItem('StaffpageIndex');
                            var staffHome = {
                                loginToken: "B1EBE47605952CF875EB795F811CE3E4",
                                companyId: 12,
                                pageIndex: pageIndex,
                                pageSize: pageSize
                            }
                            staffChangeFun(staffHome);
                        }
                    })
        });
    }
    //点击重盘保存
    $(document).on('click','#restock-form .btn-primary', function () {
        var restockNumber=$('#restock-number').val();
        var re = /^[0-9]+.?[0-9]*$/;
        var num=re.test(restockNumber)
        if(num==false){
            swal({
                title: "请输入一个数字",
                text: false,
                type: "error",
                showCancelButton: false,
                showConfirmButton: true,
                timer:1500
            })
        }
        console.log(restockNumber)
    })
    //保存盘点库存
    $(document).on('click','.stock_num_save',function(){
        var stockInput=$(this).siblings('input').val();
        if(stockInput==''){
            swal({
                title: "没有可保存的数据",
                text: false,
                type: "error",
                showCancelButton: false,
                showConfirmButton: true,
            })
        }
        console.log(stockInput)
    })
</script>
</body>
</html>
